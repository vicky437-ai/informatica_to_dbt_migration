-- Mart: MTRL_MASTER
-- Final fact table for material master data ready for consumption
-- Data flow: Sources -> Transformations -> fct_mtrl_master

{{
    config(
        materialized='table',
        tags=['itemmaster', 'mart', 'fact']
    )
}}

select
    mtrl_nbr,
    pkgng_mtrl_grp,
    mtrl_grp,
    wgt_unit_cd,
    vol_unit_cd,
    mtrl_vol,
    size_dim,
    lvl_7_cd,
    old_mtrl_nbr,
    net_wgt,
    lab_dsgn_ofc,
    ean_upc_nbr,
    gross_wgt,
    gnrl_item_cat_grp,
    entrnl_mtrl_grp,
    division_cd,
    x_plnt_mtrl_sts_dt,
    x_plnt_mtrl_sts,
    ean_cat,
    auth_grp,
    mtrl_tp,
    industry_sctr,
    dcmnt_pg_nbr,
    industry_std_desc,
    dcmnt_vrsn,
    dcmnt_tp,
    dcmnt_chng_nbr,
    cad_ind,
    basic_mtrl,
    pg_format,
    bulk_lqd_ind,
    hgly_vscs_ind,
    envmnt_rlvnt_ind,
    dcmnt_nbr,
    pckng_cd,
    aprvd_btch_rcrd_ind,
    tot_shlf_lf,
    tmptr_cndtn_ind,
    strg_pctg,
    strg_cndtn,
    sled_rndng_rule,
    hzrds_mtrl_nbr,
    cntnr_rqrmnts,
    sled_period_ind,
    gr_gl_slips,
    min_shlf_lf,
    lbl_tp,
    lbl_form,
    srl_nbr_lvl,
    mfg_nm,
    prchs_ordr_unit_ind,
    prchsg_value_key,
    mtrl_dscnt_ind,
    prchs_ordr_uom,
    mfg_pt_prfl,
    mfg_pt_nbr,
    mtrl_frt_grp,
    base_uom,
    mtrl_desc,
    danger_goods_ind,
    batch_mgmt_ind,
    disposable_ind,
    expiry_ind,
    sterile_ind,
    serialized_ind,
    created_by,
    created_dt,
    last_chg_usr,
    last_chg_dt,
    maint_status,
    commodity,
    cntry_of_orgn_cd,
    pvc_free_ind,
    dehp_free_ind,
    mercury_free_ind,
    latex_ind,
    eccn_nbr,
    pto_relevant,
    pto_relevant_qnty,
    ce_mark_ind,
    fda_prod_cd,
    dps_generic_lot,
    dps_uom_qty,
    rebox_id,
    rework_ind,
    hyp_cd,
    hyp_brand_desc,
    hazardous_ind,
    mtrl_thk_ind,
    mtrl_thk_upr_limit,
    mtrl_thk_lwr_limit,
    mtrl_thk_msrmt,
    pkgg_mtrl_tp,
    hndlng_unit_tp,
    mtrl_length,
    mtrl_wdth,
    mtrl_hgt,
    shpng_rstrctn,
    shpng_tmptr_ctrl_ind,
    scrap_itm_ind,
    rebox_ww_ind,
    rebox_nw_ind,
    instrmnt_ind,
    uod_value,
    deletion_flg,
    current_timestamp() as etl_load_dt
from {{ ref('int_final_mtrl_master') }}